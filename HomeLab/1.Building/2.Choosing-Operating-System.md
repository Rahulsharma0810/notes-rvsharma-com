## Choosing the Operating System

### ðŸ§  Goals & Considerations

Before installing any OS, I had a few **key performance indicators (KPIs)** and **risk indicators (KRIs)** in mind. I also tested most options before finalizing anything.

**Requirements:**

- âœ… High performance (no resource drain on GUI)
- âœ… Easy Kubernetes deployment via virtualization
- âœ… Full use of RTX 4080/4090 GPU for LLM use/training
- âœ… ðŸ‘¨â€â¤ï¸â€ðŸ‘¨ Flexing Â 
Â  - Control **RGB lights** on fans Â 
Â  - Display **CPU temperature** on ARGB cooler screen 
---

### âŒ Windows 11

#### âœ… Pros:

- Plug-and-play support for motherboard, GPU, and accessories Â 
- Official **Ant Esports** software for ARGB display Â 

#### âŒ Cons:

- **WSL2 isn't ideal for Kubernetes clusters** Â 
Â  - Dynamic disk sizing is inefficient Â 
Â  - Static IP assignment is a pain Â 
- **Hyper-V** lacks proper **USB passthrough support** Â 
- GUI overhead wastes compute for a homelab setup Â 

#### âš™ï¸ Notes on WSL2 Setup

```bash

# ~/.wslconfig

[wsl2]

memory=24GBÂ  # Limits usage to 75% (24GB) of system memory
```

> [Source: fizzylogic.nl](https://fizzylogic.nl/2023/01/05/how-to-configure-memory-limits-in-wsl2)  

**Manual WSL2 Install:**

```
Wsl --import microk 8 s D:\\microk 8 s "C:\\Users\\sharm\\Downloads\\ubuntu-noble-wsl-amd 64-ubuntu 24.04 lts. Rootfs. Tar. Gz" --version 2
```

Disable auto-mounts with:

```
[boot]
systemd=true

[automount]
enabled = false
```

Installed MicroK8s using Snap, but faced issues managing cluster configuration (e.g., editing kube-apiserver.yaml for certs/IP).


> ðŸ’¡ **Note**: Tried **Armoury Crate** and **Aura Sync** for RGB control, but both were buggy. Installed **OpenRGB** instead and uninstalled ASUS software. (See: [Awesome OpenRGB](#awesome-openrgb))  

âž¡ï¸ **Conclusion**: Dropped Windows to avoid wasting hours managing it, save compute power, and due to limited support for USB passthrough.

---

## **âŒ ESXi 8 Installation**
  
Installed **VMware ESXi 8** â€“ basic setup worked, and WebUI was accessible.

However, encountered an issue while installing a Windows VM:

```
Windows cannot be installed: PC does not meet requirements
```

Also, ESXi Web UI showed:

```
TPM 2.0 device detected but a connection cannot be established.
```

Despite enabling TPM, UEFI, and other BIOS settings, the issue persisted.

âš ï¸ Found online reports about **ESXi struggling with GPU passthrough**, which is a **deal-breaker** for future LLM workloads.

---

## **âœ… Proxmox VE Installation**

Installed **Proxmox VE 8** on a temporary SSD to test **OpenRGB** compatibility.

â€¢ âœ… Detected all devices on ASUS ROG X670E-E

â€¢ âœ… HyperX RAM RGB working via OpenRGB

â€¢ âŒ Motherboard RGB not detected


Tested **USB passthrough** from Proxmox to a Windows VM:

â€¢ Installed Armoury Crate & Aura Sync
â€¢ **Nothing was detected** by the apps, even with raw PCIe passthrough

> â— Even after passing all USB and PCI devices, Windows failed to detect the ARGB controllers.

---

**ðŸŽ¨ Awesome OpenRGB**

Installed **OpenRGB** on Debian following this [guide](https://pmcvtm.com/adding-openrgb-to-proxmox).

**âœ… What Worked**

![[attachments/2024-12-11_15-36-41.png]]

| **Feature**           | **Status**     | **Notes**                                                                           |
| --------------------- | -------------- | ----------------------------------------------------------------------------------- |
| Memory RGB            | âœ… Working      | Fully detected and controllable                                                     |
| Motherboard RGB       | âŒ Not Detected | [Created issue](https://gitlab.com/CalcProgrammer1/OpenRGB/-/issues/4397) #followup |
| Liquid Cooler Display | âŒ Not Detected | Needs more research #tasks                                                          |

**ðŸ¡ Integrating OpenRGB with Home Assistant**

Installed this [Home Assistant plugin](https://github.com/koying/openrgb_ha) to control lighting through Home Assistant â†’ HomeKit.  

> ðŸŽ¯ Goal: Control RGB lighting via automations or Siri/Shortcuts.